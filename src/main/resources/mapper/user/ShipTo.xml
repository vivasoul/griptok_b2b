<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.griptk.b2b.user.mapper.ShipToMapper">
	
	<select id="getShippingInfo" parameterType="Integer" resultType="java.util.HashMap">
		SELECT user_no, 
			receiver_nm,
			CONCAT('(', post_code, ') ', shipto_addr1, ' ', shipto_addr2) as addr,
			receiver_tel,
			reg_dt,
			shipto_no,
			shipto_nm,
			upd_dt
		FROM
			tb_shipto_addr
		WHERE
			user_no = #{user_no}
	</select>
	
	<select id="deleteShippingInfo" parameterType="com.griptk.b2b.user.domain.ShipToVO">
		DELETE FROM
			tb_shipto_addr
		WHERE
			user_no = #{user_no}
		AND 
			shipto_no = #{shipto_no}
	</select>
	
	<insert id="addShippingInfo" parameterType="com.griptk.b2b.user.domain.ShipToVO" >
		INSERT INTO tb_shipto_addr(
			user_no, 
			receiver_nm,
			shipto_addr1,
			shipto_addr2,
			receiver_tel,
			reg_dt,
			shipto_no,
			shipto_nm,
			upd_dt,
			post_code 
		)
		VALUES (
			#{user_no}, 
			#{receiver_nm},
			#{shipto_addr1},
			#{shipto_addr2},
			#{receiver_tel},
			NOW(),
			#{shipto_no},
			#{shipto_nm},
			NOW(),
			#{post_code}
		)
	</insert>
	
	
	
	<insert id="changeShipTo" parameterType="com.griptk.b2b.user.domain.ShipToVO" >
		INSERT INTO tb_shipto_addr(
			user_no, 
			receiver_nm,
			shipto_addr1,
			shipto_addr2,
			receiver_tel,
			reg_dt,
			shipto_no,
			shipto_nm,
			upd_dt,
			post_code
		)
		VALUES (
			#{user_no}, 
			#{receiver_nm},
			#{shipto_addr1},
			#{shipto_addr2},
			#{receiver_tel},
			NOW(),
			#{shipto_no},
			#{shipto_nm},
			NOW(),
			#{post_code}
		)
		ON DUPLICATE KEY UPDATE
			receiver_nm = #{receiver_nm},
			shipto_addr1 = #{shipto_addr1},
			shipto_addr2 = #{shipto_addr2},
			receiver_tel = #{receiver_tel},
			shipto_nm = #{shipto_nm},
			post_code = #{post_code},
			upd_dt = NOW()
	</insert>
	
</mapper>