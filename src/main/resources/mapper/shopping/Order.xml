<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.griptk.b2b.shopping.mapper.OrderMapper">
	<select id="listOrder" parameterType="int" resultType="com.griptk.b2b.shopping.domain.OrderDetailVO">
		SELECT 
			a.order_no,
			DATE_FORMAT(a.reg_dt,'%Y/%m/%d') as reg_dt,
			a.order_title,
			a.tot_order_cost,
			b.cd_nm AS order_status	
		FROM tb_order a
		INNER JOIN tb_code b
		ON a.order_status = b.cd AND b.div_cd = 'ORDER_STATUS_CODE'
		WHERE 1=1
		AND a.user_no = #{user_no}
	</select>
	
	<select id="selectOrder" parameterType="com.griptk.b2b.shopping.domain.OrderedVO" resultType="com.griptk.b2b.shopping.domain.OrderedVO">
		SELECT 
			a.order_no,a.invoice_no,a.sender,a.receiver,a.memo,a.recv_addr,b.order_dt
		FROM tb_order_detail a
		INNER JOIN tb_order b
		ON (a.order_no = b.order_no AND b.user_no = #{user_no})
		WHERE 1=1
		AND a.order_no = #{order_no}
	</select>
	
	<select id="listChildOrder" parameterType="com.griptk.b2b.shopping.domain.OrderedVO" resultType="com.griptk.b2b.shopping.domain.OrderVO">
		SELECT 
			a.order_no,b.title,a.order_cnt,a.order_cost
		FROM tb_order_list a
		INNER JOIN tb_product b ON a.product_id = b.product_id
		INNER JOIN tb_order c ON a.order_no = c.order_no
		WHERE 1 = 1 
		AND a.order_no = #{order_no}
		AND c.user_no = #{user_no}
	</select>
</mapper>